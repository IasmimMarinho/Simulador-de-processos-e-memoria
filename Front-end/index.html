<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/gantt.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <title>Escalonador de processos</title>

</head>
<body>
    <div id="container_view">
    <header id="cabecalho">Digite os dados do sistema e de cada processo</header>
    <div id="inputs-container">
        <input type="number" id="quantidade-processos" placeholder="Quantidade de processos">
    </div> 

    <script>
        let numProcessos;
        let quantum;
        let sobrecarga;
        let processos = [];
        var header = document.getElementById("cabecalho");
        
        function pedirQuantidadeProcessos() {
            numProcessos = parseInt(document.getElementById("quantidade-processos").value);
            limparInputs();
            pedirQuantum();
        }

        function pedirQuantum() {
            const inputQuantum = criarInput("number", "Valor do quantum");
            inputQuantum.addEventListener("change", () => {
                quantum = parseInt(inputQuantum.value);
                limparInputs();
                pedirSobrecarga();
            });
            document.getElementById("inputs-container").appendChild(inputQuantum);
        }

        function pedirSobrecarga() {
            const inputSobrecarga = criarInput("number", "Valor da sobrecarga");
            inputSobrecarga.addEventListener("change", () => {
                sobrecarga = parseInt(inputSobrecarga.value);
                limparInputs();
                pedirProcessos(0);
            });
            document.getElementById("inputs-container").appendChild(inputSobrecarga);
        }

        function pedirProcessos(index) {
            if (index < numProcessos) {
                const inputTempoChegada = criarInput("number", `Tempo de chegada do processo ${index + 1}`);
                const inputTempoExecucao = criarInput("number", `Tempo de execução do processo ${index + 1}`);
                const inputDeadline = criarInput("number", `Deadline do processo ${index + 1}`);

                const divProcesso = document.createElement("div");
                divProcesso.appendChild(inputTempoChegada);
                divProcesso.appendChild(inputTempoExecucao);
                divProcesso.appendChild(inputDeadline);

                document.getElementById("inputs-container").appendChild(divProcesso);

                const proximoIndex = index + 1;

                inputDeadline.addEventListener("change", () => {
                    processos.push({
                        tempoChegada: parseInt(inputTempoChegada.value),
                        tempoExecucao: parseInt(inputTempoExecucao.value),
                        deadline: parseInt(inputDeadline.value)
                    });

                    limparInputs();
                    pedirProcessos(proximoIndex);
                });
            } else {
                header.innerHTML = "Escolha o algoritmo de escalonamento";
                console.log("Quantidade de Processos:", numProcessos);
                console.log("Quantum:", quantum);
                console.log("Sobrecarga:", sobrecarga);
                console.log("Processos:", processos);
                const fifo = criarButton("FIFO", "1");
                const sjf = criarButton("SJF", "2");
                const roundRobin = criarButton("Round Robin", "3");
                const edf = criarButton("EDF", "4");
                document.getElementById("inputs-container").appendChild(fifo);
                document.getElementById("inputs-container").appendChild(sjf);
                document.getElementById("inputs-container").appendChild(roundRobin);
                document.getElementById("inputs-container").appendChild(edf);
                fifo.addEventListener("click", getGraphic);  
                sjf.addEventListener("click", getGraphic);  
                roundRobin.addEventListener("click", getGraphic);  
                edf.addEventListener("click", getGraphic);        
            }
        }

        function criarButton(title, id) {
            const button = document.createElement("button");  
            button.textContent = title; 
            button.id = id;
            return button;
        }

        function criarInput(type, placeholder) {
            const input = document.createElement("input");
            input.type = type;
            input.placeholder = placeholder;
            return input;
        }

        function limparInputs() {
            document.getElementById("inputs-container").innerHTML = "";
        }

        document.getElementById("quantidade-processos").addEventListener("change", pedirQuantidadeProcessos);

        function getGraphic() {
            Highcharts.ganttChart('container', {
            title: {
            text: 'Gantt Chart with Progress Indicators',
            align: 'left'
            },

            xAxis: {
            min: Date.UTC(2014, 10, 17),
            max: Date.UTC(2014, 10, 30)
            },

            accessibility: {
            point: {
                descriptionFormat: '{yCategory}. ' +
                    '{#if completed}Task {(multiply completed.amount 100):.1f}% completed. {/if}' +
                    'Start {x:%Y-%m-%d}, end {x2:%Y-%m-%d}.'
            }
            },

            lang: {
            accessibility: {
                axis: {
                    xAxisDescriptionPlural: 'The chart has a two-part X axis showing time in both week numbers and days.'
                }
            }
            },

            series: [{
            name: 'Project 1',
            data: [{
                name: 'Start prototype',
                start: Date.UTC(2014, 10, 18),
                end: Date.UTC(2014, 10, 25),
                completed: {
                    amount: 0.25
                }
            }, {
                name: 'Test prototype',
                start: Date.UTC(2014, 10, 27),
                end: Date.UTC(2014, 10, 29)
            }, {
                name: 'Develop',
                start: Date.UTC(2014, 10, 20),
                end: Date.UTC(2014, 10, 25),
                completed: {
                    amount: 0.12,
                    fill: '#fa0'
                }
            }, {
                name: 'Run acceptance tests',
                start: Date.UTC(2014, 10, 23),
                end: Date.UTC(2014, 10, 26)
            }]
            }]
            });
            }
    </script>

    <div id="container"></div>
</div>
</body>
</html>
